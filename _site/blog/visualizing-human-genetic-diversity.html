<head>
    <script src="https://d3js.org/d3.v4.js"></script>
    <style>
        body {
            height: 1000px;
        }
        .tooltip {
            position: absolute;
            max-width: 500px;
            padding: 10px;
            background-color: white;
            color: black;
        }
        path {
            transition: opacity 0.25s, stroke-width 0.25s;
        }
        svg {
            display: block;
        }
    </style>
</head>

<body>
    <script>
        var dim = 1000;

        var svgContainer = d3.select("body")
            .append("svg")
            .attr("width", dim)
            .attr("height", dim);


        var ellipses = [
            {"abbreviation":"PEL","h":2493.9592,"k":-3127.3259,"a":1279.1135,"b":1279.1135,"phi":0,"common_variants":5140058,"private_common_variants":99338,"description":"Peruvian in Lima, Peru","sampled_individuals":85,"color":"#E69F00","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"MXL","h":-890.0837,"k":-3899.7116,"a":1342.6299,"b":1342.6299,"phi":0,"common_variants":5663208,"private_common_variants":43322,"description":"Mexican Ancestry in Los Angeles, California","sampled_individuals":64,"color":"#56B4E9","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"CEU","h":-3603.8755,"k":-1735.535,"a":1350.0972,"b":1350.0972,"phi":0,"common_variants":5726377,"private_common_variants":184313,"description":"Utah residents (CEPH) with Northern and Western European ancestry","sampled_individuals":99,"color":"#F0E442","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"CLM","h":-3603.8755,"k":1735.535,"a":1369.9063,"b":1369.9063,"phi":0,"common_variants":5895649,"private_common_variants":37361,"description":"Colombian in Medellin, Colombia","sampled_individuals":94,"color":"#009E73","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"PUR","h":-890.0837,"k":3899.7116,"a":1388.1292,"b":1388.1292,"phi":0,"common_variants":6053543,"private_common_variants":51810,"description":"Puerto Rican in Puerto Rico","sampled_individuals":104,"color":"#000000","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"ASW","h":2493.9592,"k":3127.3259,"a":1558.5375,"b":1558.5375,"phi":0,"common_variants":7631052,"private_common_variants":321566,"description":"African Ancestry in Southwest US","sampled_individuals":61,"color":"#0072B2","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"ACB","h":4000,"k":0,"a":1597.628,"b":1597.628,"phi":0,"common_variants":8018649,"private_common_variants":840969,"description":"African Caribbean in Barbados","sampled_individuals":96,"color":"#D55E00","fill":"none","stroke_dasharray":"none"}
        ]
        
        // Define the div for the tooltip
        var tip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("display", "none");

        var downscale = 12;
        var shift = dim/2;

        svgContainer
            .selectAll("ellipses")
            .data(ellipses)
            .enter()
            .append("path")
            .attr("id", function(d) { return d._row; })
            .attr("stroke", function(d) { return d.color; })
            .attr("stroke-width", 3)
            .attr("stroke-dasharray", function(d) { return d.stroke_dasharray; })
            .attr("fill", function(d) { return d.fill; })
            .attr("d", function(d) {
                return ["M", (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift), "A", d.a/downscale, d.b/downscale, 0, 1, 1, (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift-0.001)].join(' ')
            })
            .attr("transform", function(d) {
                return "rotate(" + d.phi*(180/Math.PI) + " " + (d.h/downscale+shift) + " " + (d.k/downscale+shift) + ")"; 
            })
            .on("mouseover", function(d) {
                d3.selectAll("path")
                    .style("opacity", 0.25);
                d3.select(this)
                    .style("cursor", "pointer")
                    .style("stroke-width", 7)
                    .style("opacity", 1);
                tip
                    .style("display", "block")
                    .html("<h3 style='margin: 0px;'>" + d.description + "</h3></br>1KGP Abbreviation: " + d.abbreviation + "</br>Number of Sampled Individuals: " + d.sampled_individuals.toLocaleString() + "</br>Number of Common Variants: " + d.common_variants.toLocaleString() + "</br>Number of Private Common Variants: "+d.private_common_variants.toLocaleString())
                    .style("border", d.color + " solid 7px")
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY+25) + "px");
            })
            .on("mouseout", function(d) {
                tip.style("display", "none");
                d3.selectAll("path")
                    .style("opacity", 1)
                    .style("stroke-width", 3);
            });
        
    </script>

    <script>
        var dim = 1000;

        var svgContainer = d3.select("body")
            .append("svg")
            .attr("width", dim)
            .attr("height", dim);

        
        var ellipses = [
            {"abbreviation":"ACB","h":-165.57,"k":-320.8919,"a":1688.0641,"b":1461.761,"phi":3.8504,"common_variants":8018649,"private_common_variants":840969,"description":"African Caribbean in Barbados","sampled_individuals":96,"color":"#D55E00","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"ASW","h":0,"k":-320.8919,"a":1343.829,"b":1757.6228,"phi":2.9027,"common_variants":7631052,"private_common_variants":321566,"description":"African Ancestry in Southwest US","sampled_individuals":61,"color":"#0072B2","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"CEU","h":309.7816,"k":238.6397,"a":1218.2328,"b":1425.9545,"phi":5.6391,"common_variants":5726377,"private_common_variants":184313,"description":"Utah residents (CEPH) with Northern and Western European ancestry","sampled_individuals":99,"color":"#F0E442","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"CLM","h":370.803,"k":102.2195,"a":1311.4421,"b":1365.1961,"phi":2.8754,"common_variants":5895649,"private_common_variants":37361,"description":"Colombian in Medellin, Colombia","sampled_individuals":94,"color":"#009E73","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"MXL","h":400.7516,"k":119.7337,"a":1396.6397,"b":1240.6193,"phi":5.8156,"common_variants":5663208,"private_common_variants":43322,"description":"Mexican Ancestry in Los Angeles, California","sampled_individuals":64,"color":"#56B4E9","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"PEL","h":464.0292,"k":114.5124,"a":1447.2409,"b":1089.9208,"phi":5.5804,"common_variants":5140058,"private_common_variants":99338,"description":"Peruvian in Lima, Peru","sampled_individuals":85,"color":"#E69F00","fill":"none","stroke_dasharray":"none"},
            {"abbreviation":"PUR","h":253.8179,"k":148.2809,"a":1378.412,"b":1351.8388,"phi":5.109,"common_variants":6053543,"private_common_variants":51810,"description":"Puerto Rican in Puerto Rico","sampled_individuals":104,"color":"#000000","fill":"none","stroke_dasharray":"none"}
        ] 
        
        // Define the div for the tooltip
        var tip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("display", "none");

        var downscale = 12;
        var shift = dim/2;

        svgContainer
            .selectAll("ellipses")
            .data(ellipses)
            .enter()
            .append("path")
            .attr("id", function(d) { return d._row; })
            .attr("stroke", function(d) { return d.color; })
            .attr("stroke-width", 3)
            .attr("stroke-dasharray", function(d) { return d.stroke_dasharray; })
            .attr("fill", function(d) { return d.fill; })
            .attr("d", function(d) {
                return ["M", (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift), "A", d.a/downscale, d.b/downscale, 0, 1, 1, (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift-0.001)].join(' ')
            })
            .attr("transform", function(d) {
                return "rotate(" + d.phi*(180/Math.PI) + " " + (d.h/downscale+shift) + " " + (d.k/downscale+shift) + ")"; 
            })
            .on("mouseover", function(d) {
                d3.selectAll("path")
                    .style("opacity", 0.25);
                d3.select(this)
                    .style("cursor", "pointer")
                    .style("stroke-width", 7)
                    .style("opacity", 1);
                tip
                    .style("display", "block")
                    .html("<h3 style='margin: 0px;'>" + d.description + "</h3></br>1KGP Abbreviation: " + d.abbreviation + "</br>Number of Sampled Individuals: " + d.sampled_individuals.toLocaleString() + "</br>Number of Common Variants: " + d.common_variants.toLocaleString() + "</br>Number of Private Common Variants: "+d.private_common_variants.toLocaleString())
                    .style("border", d.color + " solid 7px")
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY+25) + "px");
            })
            .on("mouseout", function(d) {
                tip.style("display", "none");
                d3.selectAll("path")
                    .style("opacity", 1)
                    .style("stroke-width", 3);
            });
        
    </script>

    <script>
        var dim = 1000;

        var svgContainer = d3.select("body")
            .append("svg")
            .attr("width", dim)
            .attr("height", dim);

        
        var ellipses = [
            {"h":0,"k":0,"a":30654.4403,"b":30654.4403,"phi":1.2831,"color":"#A9A9A9","fill":"none","stroke_dasharray":"5","_row":"Measurable"},
            {"h":3914.4746,"k":0,"a":5388.9943,"b":5388.9943,"phi":1.2831,"color":"#A9A9A9","fill":"none","stroke_dasharray":"5","_row":"Variants"},
            {"h":5298.0686,"k":374.7268,"a":1504.1241,"b":1621.3241,"phi":-1.4451,"color":"#D55E00","fill":"none","stroke_dasharray":"none","_row":"ACB"},
            {"h":5474.7025,"k":470.2431,"a":1673.1067,"b":1407.9946,"phi":-0.7619,"color":"#0072B2","fill":"none","stroke_dasharray":"none","_row":"ASW"},
            {"h":5316.7065,"k":1021.3918,"a":1194.4565,"b":1447.7299,"phi":3.5984,"color":"#F0E442","fill":"none","stroke_dasharray":"none","_row":"CEU"},
            {"h":5448.0844,"k":965.1467,"a":1377.5539,"b":1298.0027,"phi":2.092,"color":"#009E73","fill":"none","stroke_dasharray":"none","_row":"CLM"},
            {"h":5468.3225,"k":1001.5419,"a":1365.9981,"b":1250.2533,"phi":0.5089,"color":"#56B4E9","fill":"none","stroke_dasharray":"none","_row":"MXL"},
            {"h":5529.5108,"k":1039.2751,"a":1103.765,"b":1402.8377,"phi":1.7897,"color":"#E69F00","fill":"none","stroke_dasharray":"none","_row":"PEL"},
            {"h":5340.2384,"k":940.1207,"a":1433.9201,"b":1278.6836,"phi":2.7863,"color":"#000000","fill":"none","stroke_dasharray":"none","_row":"PUR"}
        ] 

        // Define the div for the tooltip
        var tip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("display", "none");

        var downscale = 100;
        var shift = dim/2;

        svgContainer
            .selectAll("ellipses")
            .data(ellipses)
            .enter()
            .append("path")
            .attr("id", function(d) { return d._row; })
            .attr("stroke", function(d) { return d.color; })
            .attr("stroke-width", 2)
            .attr("stroke-dasharray", function(d) { return d.stroke_dasharray; })
            .attr("fill", function(d) { return d.fill; })
            .attr("d", function(d) {
                return ["M", (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift), "A", d.a/downscale, d.b/downscale, 0, 1, 1, (d.h/downscale+d.a/downscale+shift), (d.k/downscale+shift-0.001)].join(' ')
            })
            .attr("transform", function(d) {
                return "rotate(" + d.phi*(180/Math.PI) + " " + (d.h/downscale+shift) + " " + (d.k/downscale+shift) + ")"; 
            });

        function wrap(text, width) {
            text.each(function () {
                var text = d3.select(this),
                    words = text.text().split(/\s+/).reverse(),
                    word,
                    line = [],
                    lineNumber = 0,
                    lineHeight = 1.1, // ems
                    x = text.attr("x"),
                    y = text.attr("y"),
                    dy = 0, //parseFloat(text.attr("dy")),
                    tspan = text.text(null)
                                .append("tspan")
                                .attr("x", x)
                                .attr("y", y)
                                .attr("dy", dy + "em");
                while (word = words.pop()) {
                    line.push(word);
                    tspan.text(line.join(" "));
                    if (tspan.node().getComputedTextLength() > width) {
                        line.pop();
                        tspan.text(line.join(" "));
                        line = [word];
                        tspan = text.append("tspan")
                                    .attr("x", x)
                                    .attr("y", y)
                                    .attr("dy", ++lineNumber * lineHeight + dy + "em")
                                    .text(word);
                    }
                }
            });
        }

        svgContainer
            .selectAll("text")
            .data(ellipses)
            .enter()
            .filter(function(d) { return (d._row == "Measurable"); })
            .append("text")
            .text("Measurable locations in genome (~2.9 billion sites)")
            .attr("x", function(d) {return d.h/downscale+shift;})
            .attr("y", function(d) {return d.k/downscale-d.b/downscale+shift-25; })
            .style("text-anchor", "middle")
            .style("fill", "#696969")
            .style("font-family", "Arial")
            .style("font-size", 18)
            .call(wrap, 500);

        svgContainer
            .selectAll("text")
            .data(ellipses)
            .enter()
            .filter(function(d) { return (d._row == "Variants"); })
            .append("text")
            .text("Observed variants between the sampled individuals from the Americas (39,097,812 sites)")
            .attr("x", function(d) {return d.h/downscale+shift;})
            .attr("y", function(d) {return d.k/downscale-d.b/downscale+shift-60; })
            .style("text-anchor", "middle")
            .style("fill", "#696969")
            .style("font-family", "Arial")
            .style("font-size", 18)
            .call(wrap, 300);

        svgContainer
            .selectAll("text")
            .data(ellipses)
            .enter()
            .filter(function(d) { return (d._row == "CEU"); })
            .append("text")
            .text("Common variants Euler diagram for the Americas (9,991,939 sites)")
            .attr("x", function(d) {return d.h/downscale+shift-130;})
            .attr("y", function(d) {return d.k/downscale+d.b/downscale+shift-30; })
            .style("stroke", "white")
            .style("stroke-width", 20)
            .style("text-anchor", "middle")
            .style("font-family", "Arial")
            .style("font-size", 18)
            .call(wrap, 220);

        svgContainer
            .selectAll("text")
            .data(ellipses)
            .enter()
            .filter(function(d) { return (d._row == "CEU"); })
            .append("text")
            .text("Common variants Euler diagram for the Americas (9,991,939 sites)")
            .attr("x", function(d) {return d.h/downscale+shift-130;})
            .attr("y", function(d) {return d.k/downscale+d.b/downscale+shift-30; })
            .style("text-anchor", "middle")
            .style("fill", "#696969")
            .style("font-family", "Arial")
            .style("font-size", 18)
            .call(wrap, 220);
            /*
            .on("mouseover", function(d) {
                d3.selectAll("path")
                    .style("opacity", 0.25);
                d3.select(this)
                    .style("cursor", "pointer")
                    .style("stroke-width", 7)
                    .style("opacity", 1);
                tip
                    .style("display", "block")
                    .html("<h3 style='margin: 0px;'>" + d.description + "</h3></br>1KGP Abbreviation: " + d.abbreviation + "</br>Number of Sampled Individuals: " + d.sampled_individuals.toLocaleString() + "</br>Number of Common Variants: " + d.common_variants.toLocaleString() + "</br>Number of Private Common Variants: "+d.private_common_variants.toLocaleString())
                    .style("border", d.color + " solid 7px")
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY+25) + "px");
            })
            .on("mouseout", function(d) {
                tip.style("display", "none");
                d3.selectAll("path")
                    .style("opacity", 1)
                    .style("stroke-width", 3);
            })
            */
        
    </script>
</body>